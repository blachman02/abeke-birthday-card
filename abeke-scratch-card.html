<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Scratch Card ‚Äî Abeke mi ‚ù§Ô∏è</title>
  <style>
    :root{
      --card-w: 380px;      /* gift card-ish size */
      --card-h: 240px;
      --radius: 22px;
      --ink: rgba(20,20,20,.82);
      --muted: rgba(20,20,20,.62);
      --bg1: #ffb3b3;       /* light red */
      --bg2: #ff8f8f;
    }

    *{ box-sizing: border-box; }

    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      background: #111;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      padding: 18px;
    }

    .wrap{
      width: min(92vw, var(--card-w));
    }

    .card{
      position: relative;
      width: 100%;
      aspect-ratio: 19 / 12; /* close to gift card ratio */
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: 0 18px 50px rgba(0,0,0,.45);
      background: radial-gradient(1200px 500px at 20% 20%, #ffd1d1 0%, transparent 45%),
                  radial-gradient(900px 400px at 85% 80%, #ffc1c1 0%, transparent 40%),
                  linear-gradient(135deg, var(--bg1), var(--bg2));
    }

    /* subtle paper texture */
    .card::before{
      content:"";
      position:absolute; inset:0;
      background-image:
        radial-gradient(rgba(255,255,255,.18) 1px, transparent 1px),
        radial-gradient(rgba(0,0,0,.05) 1px, transparent 1px);
      background-size: 18px 18px, 24px 24px;
      background-position: 0 0, 6px 9px;
      mix-blend-mode: overlay;
      opacity: .45;
      pointer-events:none;
    }

    /* Roses (SVG background) */
    .roses{
      position:absolute; inset:-10px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='900' height='600' viewBox='0 0 900 600'%3E%3Cdefs%3E%3CradialGradient id='g' cx='50%25' cy='50%25' r='60%25'%3E%3Cstop offset='0%25' stop-color='%23b30000' stop-opacity='.95'/%3E%3Cstop offset='70%25' stop-color='%238a0000' stop-opacity='.95'/%3E%3Cstop offset='100%25' stop-color='%236a0000' stop-opacity='.95'/%3E%3C/radialGradient%3E%3ClinearGradient id='leaf' x1='0' x2='1'%3E%3Cstop offset='0%25' stop-color='%231e6b3b'/%3E%3Cstop offset='100%25' stop-color='%230f4a28'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cg opacity='.95'%3E%3Cg transform='translate(60 70)'%3E%3Ccircle cx='0' cy='0' r='70' fill='url(%23g)'/%3E%3Cpath d='M-40 -10 C-20 -60 30 -60 40 -10 C20 -30 -20 -30 -40 -10Z' fill='%23d61a1a' opacity='.55'/%3E%3Cpath d='M-45 15 C-25 -25 25 -25 45 15 C18 5 -18 5 -45 15Z' fill='%23ff5a5a' opacity='.35'/%3E%3Cpath d='M-70 80 C-40 60 -15 55 0 60 C-20 90 -45 105 -70 110Z' fill='url(%23leaf)' opacity='.95'/%3E%3Cpath d='M-5 75 C20 55 45 55 70 65 C60 95 40 110 10 118Z' fill='url(%23leaf)' opacity='.9'/%3E%3C/g%3E%3Cg transform='translate(860 520) scale(1.05)'%3E%3Ccircle cx='0' cy='0' r='76' fill='url(%23g)'/%3E%3Cpath d='M-44 -12 C-20 -66 33 -66 44 -12 C20 -34 -20 -34 -44 -12Z' fill='%23d61a1a' opacity='.55'/%3E%3Cpath d='M-48 18 C-25 -22 25 -22 48 18 C18 6 -18 6 -48 18Z' fill='%23ff5a5a' opacity='.33'/%3E%3Cpath d='M-78 88 C-44 66 -15 60 2 66 C-22 100 -50 118 -78 124Z' fill='url(%23leaf)' opacity='.95'/%3E%3Cpath d='M-2 84 C25 60 52 60 80 72 C70 108 48 126 12 134Z' fill='url(%23leaf)' opacity='.9'/%3E%3C/g%3E%3Cg transform='translate(860 90) scale(.75)'%3E%3Ccircle cx='0' cy='0' r='60' fill='url(%23g)'/%3E%3Cpath d='M-36 -10 C-16 -52 26 -52 36 -10 C16 -26 -16 -26 -36 -10Z' fill='%23d61a1a' opacity='.5'/%3E%3Cpath d='M-60 70 C-36 54 -15 50 0 54 C-18 78 -38 92 -60 96Z' fill='url(%23leaf)'/%3E%3C/g%3E%3Cg transform='translate(65 520) scale(.7)'%3E%3Ccircle cx='0' cy='0' r='58' fill='url(%23g)'/%3E%3Cpath d='M-34 -10 C-14 -50 24 -50 34 -10 C16 -25 -16 -25 -34 -10Z' fill='%23d61a1a' opacity='.5'/%3E%3Cpath d='M-58 68 C-34 52 -15 48 0 52 C-18 76 -38 90 -58 94Z' fill='url(%23leaf)'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      background-size: cover;
      background-position: center;
      opacity: .92;
      pointer-events:none;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.18));
    }

    .content{
      position:absolute; inset:0;
      padding: 22px 22px 18px;
      display:flex;
      flex-direction: column;
      gap: 10px;
      z-index: 1;
    }

    .topline{
      text-align:center;
      font-family: ui-serif, Georgia, "Times New Roman", serif;
      letter-spacing: .5px;
      font-size: 18px;
      color: var(--ink);
      margin-top: 4px;
    }

    .center{
      margin-top: 18px;
      display:flex;
      flex-direction: column;
      align-items:center;
      gap: 10px;
      flex: 1;
      justify-content: center;
    }

    .hint{
      font-size: 12px;
      color: rgba(20,20,20,.55);
      letter-spacing: .14em;
      text-transform: uppercase;
    }

    .amount{
      font-family: ui-serif, Georgia, "Times New Roman", serif;
      font-size: 46px;
      color: rgba(10,10,10,.86);
      line-height: 1;
      transform: translateY(-2px);
      opacity: 0;               /* hidden until reveal */
      transition: opacity .35s ease;
    }

    .tag{
      font-size: 14px;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: var(--muted);
      text-align:center;
    }

    .note{
      text-align:center;
      font-family: ui-serif, Georgia, "Times New Roman", serif;
      font-size: 18px;
      color: rgba(20,20,20,.75);
      margin: 6px 10px 0;
      line-height: 1.25;
    }

    .footer{
      display:flex;
      justify-content: space-between;
      gap: 10px;
      font-size: 12px;
      color: rgba(20,20,20,.62);
      margin-top: 8px;
      padding: 0 4px;
    }

    /* Scratch layer */
    canvas#scratch{
      position:absolute; inset:0;
      width:100%;
      height:100%;
      z-index: 3;
      touch-action: none;
    }

    /* Confetti canvas */
    canvas#confetti{
      position:absolute; inset:0;
      width:100%;
      height:100%;
      z-index: 4;
      pointer-events:none;
      opacity: 0;
      transition: opacity .2s ease;
    }

    .reveal-badge{
      position:absolute;
      top: 14px;
      left: 14px;
      z-index: 2;
      font-size: 11px;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: rgba(20,20,20,.62);
      background: rgba(255,255,255,.35);
      border: 1px solid rgba(255,255,255,.35);
      padding: 8px 10px;
      border-radius: 999px;
      backdrop-filter: blur(6px);
    }

    .done-msg{
      position:absolute;
      inset:auto 14px 14px 14px;
      z-index: 2;
      text-align:center;
      font-size: 12px;
      color: rgba(20,20,20,.65);
      opacity: 0;
      transform: translateY(6px);
      transition: opacity .35s ease, transform .35s ease;
    }

    .revealed .amount{ opacity: 1; }
    .revealed .done-msg{ opacity: 1; transform: translateY(0); }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="card">
      <div class="roses"></div>

      <div class="reveal-badge">Scratch to reveal</div>

      <div class="content">
        <div class="topline">Happy Birthday Abeke mi‚ù§Ô∏è</div>

        <div class="center">
          <div class="hint">Your surprise amount</div>
          <div class="amount" id="amount">‚Ç¶300,000</div>
          <div class="tag">SHEIN CART CLEARANCE</div>
          <div class="note">Because you deserve every single thing<br/>in that cart.</div>
        </div>

        <div class="footer">
          <div>Redeemable: Immediately</div>
          <div>From: Your Future Husband üíç</div>
        </div>
      </div>

      <div class="done-msg" id="doneMsg">Okay. Now go clear that cart üòå</div>

      <canvas id="scratch"></canvas>
      <canvas id="confetti"></canvas>
    </div>
  </div>

<script>
  // ---------- Scratch layer ----------
  const card = document.getElementById('card');
  const scratch = document.getElementById('scratch');
  const sctx = scratch.getContext('2d', { willReadFrequently: true });
  const amountEl = document.getElementById('amount');
  const confettiCanvas = document.getElementById('confetti');
  const cctx = confettiCanvas.getContext('2d');

  let isDown = false;
  let revealed = false;
  const REVEAL_THRESHOLD = 0.65; // 65% scratched before reveal

  function resizeCanvases(){
    const rect = card.getBoundingClientRect();
    scratch.width = Math.round(rect.width * devicePixelRatio);
    scratch.height = Math.round(rect.height * devicePixelRatio);
    scratch.style.width = rect.width + 'px';
    scratch.style.height = rect.height + 'px';

    confettiCanvas.width = scratch.width;
    confettiCanvas.height = scratch.height;

    // paint scratch layer (silver) + instruction
    sctx.setTransform(1,0,0,1,0,0);
    sctx.scale(devicePixelRatio, devicePixelRatio);
    const w = rect.width, h = rect.height;

    // base silver
    const grad = sctx.createLinearGradient(0,0,w,h);
    grad.addColorStop(0, '#d9d9d9');
    grad.addColorStop(0.5, '#bfbfbf');
    grad.addColorStop(1, '#e6e6e6');
    sctx.globalCompositeOperation = 'source-over';
    sctx.fillStyle = grad;
    sctx.fillRect(0,0,w,h);

    // subtle noise lines
    sctx.globalAlpha = 0.18;
    for(let i=0;i<14;i++){
      sctx.fillStyle = (i%2===0) ? '#ffffff' : '#9a9a9a';
      sctx.fillRect(0, (h/14)*i, w, 1);
    }
    sctx.globalAlpha = 1;

    // ‚Äúscratch here‚Äù label
    sctx.fillStyle = 'rgba(0,0,0,0.32)';
    sctx.font = '600 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';
    sctx.textAlign = 'center';
    sctx.fillText('SCRATCH HERE', w/2, h/2 - 6);

    // switch to erase mode
    sctx.globalCompositeOperation = 'destination-out';
  }

  function pointFromEvent(e){
    const rect = scratch.getBoundingClientRect();
    let clientX, clientY;
    if(e.touches && e.touches[0]){
      clientX = e.touches[0].clientX;
      clientY = e.touches[0].clientY;
    } else {
      clientX = e.clientX;
      clientY = e.clientY;
    }
    return {
      x: clientX - rect.left,
      y: clientY - rect.top
    };
  }

  function scratchAt(x,y){
    if(revealed) return;
    // eraser brush
    sctx.beginPath();
    sctx.arc(x, y, 22, 0, Math.PI*2);
    sctx.fill();
  }

  function estimateCleared(){
    // Sample pixels (fast-ish) to estimate cleared ratio
    const rect = scratch.getBoundingClientRect();
    const w = Math.round(rect.width);
    const h = Math.round(rect.height);

    // read back at 1x CSS pixels (we drew in CSS space)
    const img = sctx.getImageData(0,0,w,h).data;
    let cleared = 0;
    const step = 8; // sampling stride
    let total = 0;
    for(let y=0; y<h; y+=step){
      for(let x=0; x<w; x+=step){
        const i = (y*w + x) * 4;
        const alpha = img[i+3]; // in destination-out, cleared pixels have alpha 0
        if(alpha === 0) cleared++;
        total++;
      }
    }
    return cleared / total;
  }

  function onReveal(){
    if(revealed) return;
    revealed = true;

    // show amount
    card.classList.add('revealed');

    // remove scratch interactions
    scratch.style.pointerEvents = 'none';

    // confetti + sound
    startConfetti();
    playCelebrationSound();
  }

  scratch.addEventListener('pointerdown', (e)=>{
    if(revealed) return;
    isDown = true;
    scratch.setPointerCapture(e.pointerId);
    const p = pointFromEvent(e);
    scratchAt(p.x, p.y);
  });

  scratch.addEventListener('pointermove', (e)=>{
    if(!isDown || revealed) return;
    const p = pointFromEvent(e);
    scratchAt(p.x, p.y);
  });

  scratch.addEventListener('pointerup', ()=>{
    if(revealed) return;
    isDown = false;
    const clearedRatio = estimateCleared();
    if(clearedRatio >= REVEAL_THRESHOLD){
      onReveal();
    }
  });

  scratch.addEventListener('pointercancel', ()=>{ isDown=false; });

  // ---------- Confetti ----------
  let confettiRunning = false;
  let particles = [];

  function rand(min,max){ return Math.random()*(max-min)+min; }

  function makeParticles(){
    const count = 160;
    particles = [];
    for(let i=0;i<count;i++){
      particles.push({
        x: rand(0, confettiCanvas.width),
        y: rand(-confettiCanvas.height, 0),
        vx: rand(-1.2, 1.2) * devicePixelRatio,
        vy: rand(1.6, 3.4) * devicePixelRatio,
        r: rand(3, 7) * devicePixelRatio,
        rot: rand(0, Math.PI*2),
        vr: rand(-0.12, 0.12),
        life: rand(80, 140),
        shape: Math.random() > 0.6 ? 'rect' : 'circle'
      });
    }
  }

  function startConfetti(){
    if(confettiRunning) return;
    confettiRunning = true;
    confettiCanvas.style.opacity = 1;
    makeParticles();
    requestAnimationFrame(tickConfetti);

    // stop after a bit
    setTimeout(()=>{
      confettiRunning = false;
      confettiCanvas.style.opacity = 0;
      setTimeout(()=>{ cctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height); }, 250);
    }, 2200);
  }

  function tickConfetti(){
    if(!confettiRunning) return;
    cctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);

    for(const p of particles){
      p.x += p.vx;
      p.y += p.vy;
      p.rot += p.vr;
      p.vy += 0.02 * devicePixelRatio; // gravity

      // simple wrap
      if(p.y > confettiCanvas.height + 40*devicePixelRatio){
        p.y = rand(-200*devicePixelRatio, -20*devicePixelRatio);
        p.x = rand(0, confettiCanvas.width);
        p.vy = rand(1.6, 3.4) * devicePixelRatio;
      }

      // draw
      cctx.save();
      cctx.translate(p.x, p.y);
      cctx.rotate(p.rot);

      // random-ish festive colors without hardcoding a palette overload
      const hue = (Math.floor(rand(0, 360)));
      cctx.fillStyle = `hsla(${hue}, 85%, 60%, 0.95)`;

      if(p.shape === 'rect'){
        cctx.fillRect(-p.r, -p.r/2, p.r*2, p.r);
      } else {
        cctx.beginPath();
        cctx.arc(0,0,p.r*0.85,0,Math.PI*2);
        cctx.fill();
      }
      cctx.restore();
    }

    requestAnimationFrame(tickConfetti);
  }

  // ---------- Sound (Web Audio ‚Äî no files needed) ----------
  function playCelebrationSound(){
    // Must be triggered by user interaction; reveal happens after scratch => fine.
    try{
      const AudioContext = window.AudioContext || window.webkitAudioContext;
      const ctx = new AudioContext();

      const now = ctx.currentTime;

      function tone(freq, start, dur, type='sine', gain=0.08){
        const osc = ctx.createOscillator();
        const g = ctx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, start);
        g.gain.setValueAtTime(0.0001, start);
        g.gain.exponentialRampToValueAtTime(gain, start + 0.02);
        g.gain.exponentialRampToValueAtTime(0.0001, start + dur);
        osc.connect(g).connect(ctx.destination);
        osc.start(start);
        osc.stop(start + dur + 0.02);
      }

      // cute 3-note sparkle
      tone(659.25, now + 0.00, 0.18, 'triangle', 0.09); // E5
      tone(783.99, now + 0.10, 0.18, 'triangle', 0.09); // G5
      tone(987.77, now + 0.20, 0.26, 'sine',     0.10); // B5

      // close context shortly after
      setTimeout(()=>ctx.close(), 900);
    } catch(e){
      // if audio fails, no drama
    }
  }

  // init
  resizeCanvases();
  window.addEventListener('resize', resizeCanvases);

  // Prevent scrolling while scratching on mobile
  scratch.addEventListener('touchmove', (e)=> e.preventDefault(), { passive:false });
</script>
</body>
</html>